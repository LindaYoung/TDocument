#### 一、HTTP 和 HTTPS的区分

##### 概念

HTTP：超文本传输协议，是互联网上应用最为广泛的一种网络协议。设计HTTP最初的目的是为了提供 一种发布和接受HTML页面的方法。HTTP协议是以明文方式发送信息的。



HTTPS: 是以安全为目的的HTTP通道，是HTTP的安全版。HTTPS的安全基础是SSL。SSL协议位于TCP/IP协议与各种应用层协议之间，为你数据通讯提供安全支持。SSL协议可分为两层：SSL记录协议（SSL Record Protocol)，它建立在可靠的传输协议之上，为高层协议提供数据封装、压缩、加密等基本功能支持；SSL握手协议（SSL Handshake Protocol），它建立在SSL记录协议之上，用于在实际的数据传输开始前，通讯双方进行身份验证、协商加密算法、交换加密密钥等。



![image-20210527112949686](/Users/young1/Library/Application Support/typora-user-images/image-20210527112949686.png)

##### 原理

HTTP原理：

- 客户端的浏览器首先要通过网络与服务器建立连接，该连接是通过TCP来完成的，一般TCP连接的端口号是80。建立连接后，客户机发送一个请求给服务器，请求的格式为：统一资源标识符（URL）、协议版本号，后边是MIME信息包括请求修饰符、客户机信息和许可内容。
- 服务器接到请求后，给予相应的响应消息，其格式为一个状态行，包括信息的协议版本号、一个成功或错误代码，后面是MIME信息包括服务器信息、实体信息和可能的内容。



HTTPS设计目标：

- 数据保密性：保证数据内容在传输的过程中不会被第三方查看。
- 数据完整性：及时发现被第三方篡改的传输内容。
- 身份校验安全性：保证数据到达用户情网的目的地。



##### 区分总结

- HTTPS协议需要到CA(Certificate Authority， 证书颁发机构)申请证书，需要一定的费用。
- HTTP是超文本传输协议，信息是明文传输；HTTPS则是具有安全性的SSL加密传输协议。
- HTTP的连接很简单，是无状态的；HTTPS协议是有SSL+HTTP协议构建的可进行加密传输、身份认证的网络协议，比HTTP协议安全。（无状态的意思是其数据包的发送、传输和接收都是相互独立的。无连接的意思是指通信双方都不长久的维持对方的任何消息）



##### 传输过程

![image-20210527115702990](/Users/young1/Library/Application Support/typora-user-images/image-20210527115702990.png)

① 客户端的浏览器向服务器发送请求，并传送客户端 SSL 协议的版本号，加密算法的种类，产生的随机数，以及其他服务器和客户端之间通讯所需要的各种信息。

② 服务器向客户端传送 SSL 协议的版本号，加密算法的种类，随机数以及其他相关信息，同时服务器还将向客户端传送自己的证书。

③ 客户端利用服务器传过来的信息验证服务器的合法性，服务器的合法性包括：证书是否过期，发行服务器证书的 CA 是否可靠，发行者证书的公钥能否正确解开服务器证书的 "发行者的数字签名"，服务器证书上的域名是否和服务器的实际域名相匹配。如果合法性验证没有通过，通讯将断开；如果合法性验证通过，将继续进行第四步。 

④ 用户端随机产生一个用于通讯的 "对称密码"，然后用服务器的公钥（服务器的公钥从步骤②中的服务器的证书中获得）对其加密，然后将加密后的“预主密码”传给服务器。

⑤ 如果服务器要求客户的身份认证（在握手过程中为可选），用户可以建立一个随机数然后对其进行数据签名，将这个含有签名的随机数和客户自己的证书以及加密过的密钥一起传给服务器。

⑥ 如果服务器要求客户的身份认证，服务器必须检验客户证书和签名随机数的合法性，具体的合法性验证过程包括：客户的证书使用日期是否有效，为客户提供证书的 CA 是否可靠，发行 CA 的公钥能否正确解开客户证书的发行 CA 的数字签名，检查客户的证书是否在证书废止列表（CRL）中。检验如果没有通过，通讯立刻中断；如果验证通过，服务器将用自己的私钥解开加密的私钥，然后执行一系列步骤来产生主通讯密码（客户端也将通过同样的方法产生相同的主通讯密码）。 

⑦ 服务器和客户端用相同的对称加密密钥，对称密钥用于 SSL 协议的安全数据通讯的加解密通讯。同时在 SSL 通讯过程中还要完成数据通讯的完整性，防止数据通讯中的任何变化。

⑧ 客户端向服务器端发出信息，指明后面的数据通讯将使用的步骤 ⑦ 中的主密码为对称密钥，同时通知服务器客户端的握手过程结束。

⑨ 服务器向客户端发出信息，指明后面的数据通讯将使用的步骤 ⑦ 中的主密码为对称密钥，同时通知客户端服务器端的握手过程结束。

⑩ SSL 的握手部分结束，SSL 安全通道的数据通讯开始，客户和服务器开始使用相同的对称密钥进行数据通讯，同时进行通讯完整性的检验。

[参考文档](https://blog.csdn.net/qq_38289815/article/details/80969419)

